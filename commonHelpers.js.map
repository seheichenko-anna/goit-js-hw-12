{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loadBtn = document.querySelector('.load-btn');\nconst loader = document.querySelector('.loader');\n\nlet lightbox;\nlet countPage;\nlet searchValue;\n\nform.addEventListener('submit', onSearchImages);\nloadBtn.addEventListener('click', onLoadImages);\n\nfunction onSearchImages(e) {\n  e.preventDefault();\n  gallery.innerHTML = '';\n  loader.classList.remove('hidden');\n  searchValue = form.elements.q.value.trim();\n  if (searchValue !== '') {\n    getImages(searchValue)\n      .then(data => {\n        if (data.hits.length === 0) {\n          iziToast.show({\n            message:\n              'Sorry, there are no images matching your search query. Please try again!',\n            position: 'topRight',\n            backgroundColor: '#EF4040',\n            titleColor: '#FFFFFF',\n            messageColor: '#FFFFFF',\n          });\n          loadBtn.classList.add('hidden');\n        } else {\n          countPage = 1;\n          renderGallery(data.hits);\n          loadBtn.classList.remove('hidden');\n        }\n      })\n      .catch(error => console.log(error))\n      .finally(() => {\n        loader.classList.add('hidden');\n      });\n  } else {\n    iziToast.show({\n      message: 'Please fill out the search field',\n      position: 'topRight',\n      backgroundColor: '#EF4040',\n      titleColor: '#FFFFFF',\n      messageColor: '#FFFFFF',\n    });\n    loader.classList.add('hidden');\n  }\n  form.reset();\n}\n\nfunction getGalleryItemHeight() {\n  const galleryItem = document.querySelector('.gallery-item');\n  const { height } = galleryItem.getBoundingClientRect();\n  return height;\n}\n\nfunction onLoadImages() {\n  console.log(countPage);\n  loadBtn.classList.add('hidden');\n  loader.classList.remove('hidden');\n  const galleryItemHeight = getGalleryItemHeight();\n  getImages()\n    .then(data => {\n      if (data.totalHits - countPage * 40 <= 0) {\n        iziToast.show({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n          backgroundColor: '#03a9f4',\n          titleColor: '#FFFFFF',\n          messageColor: '#FFFFFF',\n        });\n        loadBtn.classList.add('hidden');\n      } else {\n        countPage += 1;\n        renderGallery(data.hits);\n        loadBtn.classList.remove('hidden');\n        window.scrollBy({\n          top: galleryItemHeight * 2,\n          left: 0,\n          behavior: 'smooth',\n        });\n      }\n    })\n    .catch(error => console.log(error))\n    .finally(() => {\n      loader.classList.add('hidden');\n    });\n}\n\nconst getImages = async function () {\n  const API_KEY = '42001706-084c655b89d9d100c07cefb17';\n  const url = 'https://pixabay.com/api/';\n  const response = await axios.get(url, {\n    params: {\n      key: API_KEY,\n      q: searchValue,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: countPage,\n      per_page: 40,\n    },\n  });\n  return response.data;\n};\n\nfunction renderGallery(data) {\n  const markup = data.map(item => {\n    const {\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    } = item;\n    return `<li class=\"gallery-item\">\n                <a class=\"gallery-link\" href=${largeImageURL}>\n                <img src=${webformatURL} alt=\"${tags}\" /></a>\n                    <ul class=\"image-desc\">\n                        <li class=\"image-desc-item\"><p>Likes</p><p>${likes}</p></li>\n                        <li class=\"image-desc-item\"><p>Views</p><p>${views}</p></li>\n                        <li class=\"image-desc-item\"><p>Comments</p><p>${comments}</p></li>\n                        <li class=\"image-desc-item\"><p>Downloads</p><p>${downloads}</p></li>\n                    </ul>\n            </li>`;\n  });\n\n  addMarkup(markup);\n  lightbox.refresh();\n}\n\nfunction addMarkup(markup) {\n  markup = markup.join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox = new SimpleLightbox('.gallery a', {\n    captionDelay: 250,\n    captionsData: 'alt',\n  });\n}\n"],"names":["form","gallery","loadBtn","loader","lightbox","countPage","searchValue","onSearchImages","onLoadImages","e","getImages","data","iziToast","renderGallery","error","getGalleryItemHeight","galleryItem","height","galleryItemHeight","API_KEY","url","axios","markup","item","webformatURL","largeImageURL","tags","likes","views","comments","downloads","addMarkup","SimpleLightbox"],"mappings":"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"}